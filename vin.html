<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>VIN Viewer</title>
  <style>
    body {
      font-family: sans-serif;
      background: #eef1f4;
      padding: 2rem;
      max-width: 800px;
      margin: auto;
    }
    input[type="text"] {
      width: 300px;
      padding: 8px;
      font-size: 16px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    button {
      padding: 8px 12px;
      font-size: 16px;
      margin-left: 8px;
      cursor: pointer;
    }
    .result {
      margin-top: 24px;
      padding: 16px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    }
    .result p {
      margin: 6px 0;
    }
  </style>
</head>
<body>
  <h1>ğŸ” à¸„à¹‰à¸™à¸«à¸² VIN (Model Name)</h1>
  <input id="modelInput" type="text" placeholder="à¹ƒà¸ªà¹ˆ Model name à¹€à¸Šà¹ˆà¸™ XYZ1234567">
  <button onclick="searchVIN()">à¸„à¹‰à¸™à¸«à¸²</button>

  <div id="resultBox" class="result" style="display:none;"></div>

  <script>
    const SHEET_ID = "19pJJpiDKatYgUmO_43SUyECxqTYaqfhwcQwYiuxn-d8";
    const API_KEY  = "AIzaSyAki5uoqv3JpG7sqZ7crpaALomcUxlD72k";
    const RANGE    = "VIN!A2:T";

    let vinData = [];

    async function loadVIN() {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${RANGE}?key=${API_KEY}`;
      const res = await fetch(url);
      const obj = await res.json();
      vinData = obj.values || [];
    }

    function searchVIN() {
      const keyword = document.getElementById("modelInput").value.trim();
      const found = vinData.find(row => row[0] === keyword);

      const box = document.getElementById("resultBox");
      if (!found) {
        box.innerHTML = "<p style='color:red;'>âŒ à¹„à¸¡à¹ˆà¸à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥</p>";
      } else {
        box.innerHTML = `
          <p><strong>ğŸ“… à¸›à¸µà¸£à¸¸à¹ˆà¸™:</strong> ${found[2] || "-"}</p>
          <p><strong>ğŸ› ï¸ à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¢à¸™à¸•à¹Œ:</strong> ${found[5] || "-"}</p>
          <p><strong>âš™ï¸ à¹€à¸à¸µà¸¢à¸£à¹Œ:</strong> ${found[9] || "-"}</p>
          <p><strong>ğŸš› Cab:</strong> ${found[15] || "-"}</p>
          <p><strong>ğŸ”¢ Model group:</strong> ${found[16] || "-"}</p>
          <p><strong>ğŸ›‘ Brake:</strong> ${found[19] || "-"}</p>
        `;
      }
      box.style.display = "block";
    }

    loadVIN();
  </script>
</body>
</html>
